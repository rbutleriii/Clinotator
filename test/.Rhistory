# Prediction Intervals
setwd('C:/Users/rbutl/OneDrive/Documents/NCBI Hachathon 2017/Clinotator/test/')
library(dplyr)
library(ggplot2)
library(rcompanion)
big_tbl <- read.csv('clinotator.clinvar_ge_2str.tsv', header=TRUE, sep='\t')
# US distribution
US_dist <- select(filter(big_tbl, grepl('Uncertain significance', CVCS) & CVNA >= 2),c(CTRS))
US_d2 <- sample_n(US_dist, 5000)
US_d2$CTRS = US_d2$CTRS + min(US_d2$CTRS) + 1
View(US_d2)
US_d2$CTRS = US_d2$CTRS + min(US_d2$CTRS) + 1
US_d2 <- sample_n(US_dist, 5000)
View(US_d2)
US_d2$CTRS = US_d2$CTRS + abs(min(US_d2$CTRS)) + 1
plotNormalHistogram(US_d2$CTRS)
plotNormalHistogram(US_d2$CTRS, binwidth = 20)
plotNormalHistogram(US_d2$CTRS, breaks = 20)
plotNormalHistogram(US_d2$CTRS, breaks = 40)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
plotNormalHistogram(US_d2$CTRS, breaks = 100)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2_Tuk = transformTukey(US_d2$CTRS, plotit = FALSE)
plotNormalHistogram(US_d2_Tuk, breaks = 50)
US_d2_Tuk = transformTukey(US_d2$CTRS, plotit = FALSE)
US_d2_Tuk = transformTukey(US_d2$CTRS, plotit = FALSE)
US_d2_Tuk = transformTukey(US_d2$CTRS, plotit = FALSE)
US_d2 <- sample_n(US_dist, 5000)
US_d2$CTRS = US_d2$CTRS + abs(min(US_d2$CTRS)) + 1
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2_Tuk = transformTukey(US_d2$CTRS, plotit = FALSE)
US_d2_log = log(US_d2$CTRS)
plotNormalHistogram(US_d2_log, breaks = 50)
shapiro.test(US_d2_log)
qqnorm(US_d2_log);qqline(US_d2_log)
US_d2 <- sample_n(US_dist, 2000)
US_d2$CTRS = US_d2$CTRS + abs(min(US_d2$CTRS)) + 1
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2_log = log(US_d2$CTRS)
US_d2_Tuk = transformTukey(US_d2$CTRS, plotit = FALSE)
qqnorm(US_d2_Tuk);qqline(US_d2_Tuk)
shapiro.test(US_d2_log)
US_d2 <- sample_n(US_dist, 500)
US_d2$CTRS = US_d2$CTRS + abs(min(US_d2$CTRS)) + 1
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2_log = log(US_d2$CTRS)
US_d2_Tuk = transformTukey(US_d2$CTRS, plotit = FALSE)
US_d2_kurt = US_d2$CTRS - median(US_d2$CTRS)
plotNormalHistogram(US_d2_kurt, breaks = 50)
US_d2_Tuk = transformTukey(US_d2_kurt2, plotit = FALSE)
US_d2_Tuk = transformTukey(US_d2_kurt, plotit = FALSE)
US_d2 <- sample_n(US_dist, 5000)
US_d2$CTRS = US_d2$CTRS - median(US_d2$CTRS)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2 <- sample_n(US_dist, 5000)
US_d2$CTRS = US_d2$CTRS + abs(min(US_d2$CTRS)) + 1
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2_kurt = US_d2$CTRS - median(US_d2$CTRS)
plotNormalHistogram(US_d2_kurt, breaks = 50)
US_d2 <- sample_n(US_dist, 5000)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2$CTRS = US_d2$CTRS - median(US_d2$CTRS)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2$CTRS = US_d2$CTRS + abs(min(US_d2$CTRS)) + 1
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2 <- sample_n(US_dist, 5000)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2$CTRS = US_d2$CTRS + abs(min(US_d2$CTRS)) + 1
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2$CTRS = US_d2$CTRS - median(US_d2$CTRS)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2 <- sample_n(US_dist, 5000)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2$CTRS = sign(US_d2$CTRS) * (abs(US_d2$CTRS))^(1/3)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2 <- sample_n(US_dist, 5000)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2 <- sample_n(US_dist, 5000)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2$CTRS = sign(US_d2$CTRS) * (abs(US_d2$CTRS))^(3/4)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
shapiro.test(US_d2$CTRS)
US_d2 <- sample_n(US_dist, 5000)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2$CTRS = sign(US_d2$CTRS) * (abs(US_d2$CTRS))^(1/3)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
shapiro.test(US_d2$CTRS)
US_d2 <- sample_n(US_dist, 5000)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2$CTRS = sign(US_d2$CTRS) * (abs(US_d2$CTRS))^(1/4)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
shapiro.test(US_d2$CTRS)
US_d2 <- sample_n(US_dist, 5000)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2$CTRS = sign(US_d2$CTRS) * (abs(US_d2$CTRS))^(1/10)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
shapiro.test(US_d2$CTRS)
US_d2 <- sample_n(US_dist, 5000)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2$CTRS = sign(US_d2$CTRS) * (abs(US_d2$CTRS))^(3/4)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
shapiro.test(US_d2$CTRS)
US_d2 <- sample_n(US_dist, 5000)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2$CTRS = sign(US_d2$CTRS) * (abs(US_d2$CTRS))^(4/5)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
shapiro.test(US_d2$CTRS)
US_d2 <- sample_n(US_dist, 5000)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2$CTRS = sign(US_d2$CTRS) * (abs(US_d2$CTRS))^(5/6)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
shapiro.test(US_d2$CTRS)
US_d2 <- sample_n(US_dist, 5000)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2$CTRS = sign(US_d2$CTRS) * (abs(US_d2$CTRS))^(9/10)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
shapiro.test(US_d2$CTRS)
US_d2 <- sample_n(US_dist, 5000)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2$CTRS = sign(US_d2$CTRS) * (abs(US_d2$CTRS))^(1/10)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2 <- sample_n(US_dist, 5000)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2$CTRS = sign(US_d2$CTRS) * (abs(US_d2$CTRS))^(1/1000)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2 <- sample_n(US_dist, 5000)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2 <- sample_n(US_dist, 5000)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2$CTRS = US_d2$CTRS + median(US_d2$CTRS)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2 <- sample_n(US_dist, 5000)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2$CTRS = US_d2$CTRS - median(US_d2$CTRS)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2$CTRS = sign(US_d2$CTRS) * (abs(US_d2$CTRS))^(1/1000)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2 <- sample_n(US_dist, 5000)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2$CTRS = US_d2$CTRS - median(US_d2$CTRS)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2$CTRS = sign(US_d2$CTRS) * (abs(US_d2$CTRS))^(1/100)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2 <- sample_n(US_dist, 5000)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2$CTRS = US_d2$CTRS - median(US_d2$CTRS)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
US_d2$CTRS = sign(US_d2$CTRS) * (abs(US_d2$CTRS))^(1/10)
plotNormalHistogram(US_d2$CTRS, breaks = 50)
shapiro.test(US_d2$CTRS)
